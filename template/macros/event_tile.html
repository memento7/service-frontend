{% macro emotion_bubbles(emotions, max=4) -%}
	<div class="emotion-bubbles">
		{% for emotion in emotions %}
			{% if loop.index <= max %}
			<span class="emotion">
				<i style="width: {{ emotion.weight * 16 }}px; height: {{ emotion.weight * 16 }}px; background-color: {{ rand_color() }}"></i>
				<span>{{ emotion.title }}</span>
			</span>
			{% endif %}
		{% endfor %}
	</div>
{% endmacro %}

{% macro event_tile(event, show_label=True, show_date=False) -%}
	<div class="event-tile clearfix">
		<div class="fl" style="width: calc(100% - 111px)">
			<h4>
				<a href="/event/{{ event.id }}">{{ event.title }}</a>
			</h4>

			{% if show_date %}
			<div class="date">
				{{ event.date.split("-")[0:2] | join('.') }}
			</div>
			{% endif %}
			
			{% if show_label %}
			<div>
				{% set r = issue_rank(event.issue_data) %}
				<span class="label issue-rank {{ r.rank | lower }}-rank">
					<i>{{ r.rank }}</i>
					<span>{{ r.label }}</span>
				</span>

				<span class="label event-category category-{{ event_category_id(event.type) }}">{{ event.type }}</span>
			</div>
			{% endif %}

			{{ emotion_bubbles(event.emotions) }}

		</div>
		<div class="fr" style="width: 100px">
			{% if event.images[0] %}
			<img src="{{ event.images[0].path }}" width="105">
			{% endif %}
		</div>
	</div>
{% endmacro %}


{% macro mini_event_tile(event) -%}
	<div class="event-tile mini-event-tile">
		<a href="/event/{{ event.id }}">
			<div><img src="{{ first_image(event.images) }}" width="100%"></div>
			<h4>{{ event.title }}</h4>
		</a>
		<div>
			<span class="issue-label {{ issue_rank(event.issue_data).rank | lower }}-rank"></span>
			<span class="category-label category-{{ event_category_id(event.type) }}"></span>
		</div>
		{{ emotion_bubbles(event.emotions, 2) }}
	</div>
{% endmacro %}

