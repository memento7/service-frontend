{% extends "/layouts/people_magazine.html" %}
{% import "/macros/event_tile.html" as event_tile %}

{% block head %}
	{{ super() }}

	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
	<script type="text/javascript" src="/js/people.js"></script>
{% endblock %}

		
{% block content %}
	{{ super() }}

	{% for w in in_one_word %}
	<section id="in-one-word" class="common-tile">
		<div>
			<i class="fa fa-quote-left"></i>
			<h2 style="font-size: {{ iow_size(w.keyword) }}">{{ w.keyword }}</h2>
			<i class="fa fa-quote-right"></i>
		</div>
		{% if w.reference %}
		<div class="reference">
			- {{ w.reference }}
		</div>
		{% endif %}
	</section>
	{% endfor %}


	{% if group %}
	<section id="singer-group" class="common-tile">
		<div class="title clearfix">
			<h4 class="group-title fl">{{ group.name }}</h4>
			<div class="group-company fr">{{ group.belongs }}</div>
		</div>
		<ul class="member clearfix">
			{% for member in group.members %}
			<li>
				<img src="{{ member.image }}" width="60" height="60">
				<div>{{ member.name }}</div>
			</li>
			{% endfor %}
		</ul>
	</section>
	{% endif %}


	<section id="people-trend" class="common-tile">
		<h3>왜 떴을까?</h3>
		<div class="graph-area">
			<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100%" height="105" viewBox="0 0 {{ trend_graph | length * 2 }} 105" preserveAspectRatio="none">
				<path d="M 0, 90
				{% for d in trend_graph %} L {{ 2 * loop.index }}, {{ 90 - d.value }} {% endfor %}
				" />
			</svg>
			<div class="overlay">
			{% for event in top_trends %}
				{% set x_pos = event.graph_data.index / (trend_graph | length) * 100 %}
				<span class="number" style="
					left: {{ x_pos }}%;
					top: {{ 95 - event.graph_data.value }}px;
					color: {{ event.color }};
				">{{ circular_number(loop.index) }}</span>

				<span class="date" style="
					left: {{ x_pos }}%;
				">{{ event.date.split('-')[0:2] | join('.') }}</span>
			{% endfor %}
			</div>
		</div>
		<div class="events">
		{% for event in top_trends %}
			<span class="number" style="color: {{ event.color }}">
				{{ circular_number(loop.index) }}
			</span>

			{{ event_tile.event_tile(event, True) }}
		{% endfor %}
		</div>
	</section>

	<section id="people-stats" class="common-tile">
		<h3>재미로 보는 능력치</h3>
		<div class="content clearfix total-{{ role_datas | length }}stats">
			{% for role_type, role_data in role_datas.items() %}
			{% set role_stat_info = People.role_stat_info[role_type] %}

			<div class="stat fl clearfix">
				<span class="label fl">{{ role_type }} 능력치</span>
				<span class="fr">
					<a href="./{{ role_type }}">자세히 보기</a>
				</span>
				<canvas id="stat-chart-{{ loop.index }}" width="165" height="125"></canvas>
			</div>

			<script type="text/javascript">
				makeStatChart(
					document.getElementById("stat-chart-{{ loop.index }}"),
					{{ role_stat_info | safe }},
					{{ role_data._stats | safe }}
				);
			</script>
			
			{% endfor %}
		</div>

		
	</section>
	
{% endblock %}